const c=async(s,a,r=globalThis.fetch,{delay:t,maxRetries:n}={delay:500,maxRetries:7})=>{if(!r)throw new Error("No fetch implementation found.");for(let o=0;o<=n;o++)try{const e=await r(s,a);if(!e.ok&&(await e.json()).type==="RATE_LIMIT_REACHED")throw new Error("RATE_LIMIT_REACHED");return e}catch(e){if(e.message==="RATE_LIMIT_REACHED"&&o<n)console.log("Rate limit reached. Retrying in "+t+"ms"),await new Promise(i=>setTimeout(i,t)),t*=2;else throw e}throw new Error("Max retries reached.")};export{c as fetchWithBackoff};
